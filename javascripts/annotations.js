var annotations = 
[
    {
        name: "tester.endtest",
        refs: [
            {
                text: "KB184: What is the purpose of the Tester.EndTest() Function?",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB184.aspx"
            },
            {
                text: "KB168:  Customizing the Rapise Reports",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB168.aspx"
            }
        ]
    },
    {
        name: "sessimulatedobject.doaction",
        refs: [
            {
                text: "KB126: Simulated Objects", 
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB126.aspx"
            }
        ]
    },
    {
        name: "global.dolaunch",
        refs: [
            {
                text: "KB47: Executing a process and checking if it's still running", 
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB47.aspx"
            },
            {
                text: "KB227: Executing a Windows .BAT Batch File from Rapise",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB227.aspx"
            }
        ]
    },
    {
        name: "global.doloadobjects",
        refs: [
            {
                text: "KB185: Using Global.DoLoadObjects to Use Rapise Objects from External File", 
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB185.aspx"
            }
        ]
    },
    {
        name: "global.dowaitfor",
        refs: [
            {
                text: "KB186:  Global.DoWaitFor vs Global.DoWaitForProperty", 
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB186.aspx"
            },
            {
                text: "KB135:  How does Rapise detect if a dialog is already open? ", 
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB135.aspx"
            }
        ]
    },
    {
        name: "global.dowaitforproperty",
        refs: [
            {
                text: "KB186:  Global.DoWaitFor vs Global.DoWaitForProperty", 
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB186.aspx"
            },
            {
                text: "KB130:  Waiting Until Application Ready", 
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB130.aspx"
            }
        ]
    },
    {
        name: "navigator.execjs",
        refs: [
            {
                text: "KB64: Using Navigator.ExecJS to call Javascript functions", 
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB64.aspx"
            },
            {
                text: "KB46: Executing Javascript commands against web browser", 
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB46.aspx"
            }
        ]
    },
    {
        name: "navigator.open",
        refs: [
            {
                text: "KB11: How do I change the URL of the website being tested in Rapise.", 
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB11.aspx"
            }
        ]
    },
    {
        name: "navigator.checkobjectexists",
        refs: [
            {
                text: "KB187: Using CheckObjectExists(xpathOrObjId) to See if Web Object Exists on Page", 
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB187.aspx"
            }
        ]
    },
    {
        name: "navigator.docheckprompt",
        refs: [
            {
                text: "KB97: Recording Popup JavaScript Confirmation Boxes", 
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB97.aspx"
            }
        ]
    },
    {
        name: "navigator.docheckconfirmation",
        refs: [
            {
                text: "KB97: Recording Popup JavaScript Confirmation Boxes", 
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB97.aspx"
            }
        ]
    },
    {
        name: "navigator.docheckalert",
        refs: [
            {
                text: "KB97: Recording Popup JavaScript Confirmation Boxes", 
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB97.aspx"
            }
        ]
    },
    {
        name: "tester.begintest",
        refs: [
            {
                text: "KB168:  Customizing the Rapise Reports",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB168.aspx"
            }
        ]
    },
    {
        name: "tester.ignorestatus",
        refs: [
            {
                text: "KB168:  Customizing the Rapise Reports",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB168.aspx"
            }
        ]
    },
    {
        name: "htmlobject.doselect",
        refs: [
            {
                text: "KB166:  Using Rapise to test a web page with a multi-select list",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB166.aspx"
            }
        ]
    },
    {
        name: "htmlobject.doaddselection",
        refs: [
            {
                text: "KB166:  Using Rapise to test a web page with a multi-select list",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB166.aspx"
            }
        ]
    },
    {
        name: "global.doinvoketest",
        refs: [
            {
                text: "KB127:  Passing Test Parameters",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB127.aspx"
            },
            {
                text: "KB25:  Using Global.DoInvokeTest() to pass parameters between tests",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB25.aspx"
            },
            {
                text: "KB136:  How are Global Functions stored and recalled?",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB136.aspx"
            }
        ]
    },
    {
        name: "sessimulatedobject.getstate",
        refs: [
            {
                text: "KB124: Reading an Object's State",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB124.aspx"
            },
            {
                text: "KB63: Getting the State of a Win32 object using Rapise",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB63.aspx"
            }
        ]
    },
    {
        name: "sessimulatedobject.getstate",
        refs: [
            {
                text: "KB124:  Reading an Object's State",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB124.aspx"
            },
            {
                text: "KB63:  Getting the State of a Win32 object using Rapise",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB63.aspx"
            }
        ]
    },
    {
        name: "htmlobject.dodomqueryxpath",
        refs: [
            {
                text: "KB117:  Working with HTML Tables containing Dynamic Data",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB117.aspx"
            },
            {
                text: "KB109:  Using DoDOMChildrenCount and DoDOMQueryXPath to inspect child HTML elements",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB109.aspx"
            },
            {
                text: "KB87:  Using Rapise to Validate Display of Data Grid Data",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB87.aspx"
            },
            {
                text: "KB116:  Working with HTML XPath",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB116.aspx"
            }
        ]
    },
    {
        name: "htmlobject.dodomchildrencount",
        refs: [
            {
                text: "KB109:  Using DoDOMChildrenCount and DoDOMQueryXPath to inspect child HTML elements",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB109.aspx"
            },
          	{
                text: "KB116:  Working with HTML XPath",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB116.aspx"
            }
        ]
    },
    {
        name: "database.doattach",
        refs: [
            {
                text: "KB87:  Using Rapise to Validate Display of Data Grid Data",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB87.aspx"
            }
        ]
    },
    {
        name: "database.getrowcount",
        refs: [
            {
                text: "KB87:  Using Rapise to Validate Display of Data Grid Data",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB87.aspx"
            }
        ]
    },
    {
        name: "database.dosequential",
        refs: [
            {
                text: "KB87:  Using Rapise to Validate Display of Data Grid Data",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB87.aspx"
            }
        ]
    },
    {
        name: "database.getvalue",
        refs: [
            {
                text: "KB87:  Using Rapise to Validate Display of Data Grid Data",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB87.aspx"
            }
        ]
    },
    {
        name: "spreadsheet.doattach",
        refs: [
            {
                text: "KB357: Data-driven testing with spreadsheets and RVL",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB357.aspx"
            },
            {
                text: "KB432: Writing data to an Excel spreadsheet",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB432.aspx"
            },
            {
                text: "KB372: How to save content of a table/grid into a spreadsheet file",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB372.aspx"
            },
            {
                text: "KB27:  Using Rapise to extract test data from an Excelsheet",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB27.aspx"
            }
        ]
    },
    {
        name: "spreadsheet.getrowcount",
        refs: [
            {
                text: "KB27:  Using Rapise to extract test data from an Excelsheet",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB27.aspx"
            }
        ]
    },
    {
        name: "spreadsheet.dosequential",
        refs: [
            {
                text: "KB27:  Using Rapise to extract test data from an Excelsheet",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB27.aspx"
            }
        ]
    },
    {
        name: "spreadsheet.setrange",
        refs: [
            {
                text: "KB357: Data-driven testing with spreadsheets and RVL",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB357.aspx"
            },
            {
                text: "KB432: Writing data to an Excel spreadsheet",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB432.aspx"
            },
            {
                text: "KB372: How to save content of a table/grid into a spreadsheet file",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB372.aspx"
            },
            {
                text: "KB27:  Using Rapise to extract test data from an Excelsheet",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB27.aspx"
            }
        ]
    },
    {
        name: "spreadsheet.getcell",
        refs: [
            {
                text: "KB27:  Using Rapise to extract test data from an Excelsheet",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB27.aspx"
            }
        ]
    },
    {
        name: "global.dosendkeys",
        refs: [
            {
                text: "Sending Special Keys to the current applications",
                link: "/Guide/sending_special_keys_to_the_c/"
            }
        ]
    },
    {
        name: "global.getfullpath",
        refs: [
            {
                text: "KB19:  How to successfully include and use common functions and objects",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB19.aspx"
            }
        ]
    },
    {
        name: "global.dokillbyname",
        refs: [
            {
                text: "KB18:   How Do I Ensure No Other Browser Windows Open",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB18.aspx"
            }
        ]
    },
    {
        name: "global.doruntestset",
        refs: [
            {
                text: "KB128: Creating a Set of Tests to Run in Rapise",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB128.aspx"
            }
        ]
    },
    {
        name: "htmlobject.dodomchildat",
        refs: [
          	{
                text: "KB116:  Working with HTML XPath",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB116.aspx"
            }
        ]
    },
    {
        name: "htmlobject.dodomfindparentwithattribute",
        refs: [
          	{
                text: "KB116:  Working with HTML XPath",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB116.aspx"
            }
        ]
    },
    {
        name: "htmlobject.dodomgetattribute",
        refs: [
          	{
                text: "KB116:  Working with HTML XPath",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB116.aspx"
            }
        ]
    },
    {
        name: "htmlobject.dodomnextsibling",
        refs: [
          	{
                text: "KB116:  Working with HTML XPath",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB116.aspx"
            }
        ]
    },
    {
        name: "htmlobject.dodomparent",
        refs: [
          	{
                text: "KB116:  Working with HTML XPath",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB116.aspx"
            }
        ]
    },
    {
        name: "htmlobject.dodomprevsibling",
        refs: [
          	{
                text: "KB116:  Working with HTML XPath",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB116.aspx"
            }
        ]
    },
    {
        name: "htmlobject.dodomroot",
        refs: [
          	{
                text: "KB116:  Working with HTML XPath",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB116.aspx"
            }
        ]
    },
    {
        name: "htmlobject.getstyle",
        refs: [
          	{
                text: "KB163: Accessing the Computed Style Properties of an HTML DOM Object",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB163.aspx"
            }
        ]
    },
    {
        name: "sessimulatedobject.dosendkeys",
        refs: [
          	{
                text: "KB122: Change Object Value or Text",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB122.aspx"
            }
        ]
    },
    {
        name: "sessimulatedobject.setvalue",
        refs: [
          	{
                text: "KB122: Change Object Value or Text",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB122.aspx"
            }
        ]
    },
    {
        name: "sessimulatedobject.setwindowtext",
        refs: [
          	{
                text: "KB122: Change Object Value or Text",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB122.aspx"
            }
        ]
    },
    {
        name: "win32text.dosettext",
        refs: [
          	{
                text: "KB122: Change Object Value or Text",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB122.aspx"
            }
        ]
    },
    {
        name: "sessimulatedobject.dorclick",
        refs: [
          	{
                text: "KB119: Working with Right-Click Context Menus",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB119.aspx"
            }
        ]
    },
    {
        name: "uialist.doclickitem",
        refs: [
          	{
                text: "KB119: Working with Right-Click Context Menus",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB119.aspx"
            }
        ]
    },
    {
        name: "win32contextmenu.doclickitem",
        refs: [
          	{
                text: "KB119: Working with Right-Click Context Menus",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB119.aspx"
            }
        ]
    },
    {
        name: "win32combobox.doselectitem",
        refs: [
          	{
                text: "KB118: Working with Selectable Lists",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB118.aspx"
            }
        ]
    },
    {
        name: "dynamicsnavfasttabs",
        refs: [
          	{
                text: "KB366: How to ensure that a Fast Tab is expanded and scrolled into view in Dynamics NAV",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB366.aspx"
            }
        ]
    },
    {
        name: "dynamicsnavtable",
        refs: [
          	{
                text: "KB347: How to record entering of data into Dynamics NAV tables",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB347.aspx"
            },
          	{
                text: "KB343: How to scroll Dynamics NAV table vertically and horizontally",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB343.aspx"
            }           
        ]
    },    
    {
        name: "htmlobject",
        refs: [
          	{
                text: "KB363: How to define a profile for Web Application in Rapise",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB363.aspx"
            },
          	{
                text: "KB282: Elastic XPATH Expressions",
                link: "https://www.inflectra.com/support/knowledgebase/kb282.aspx"
            },
          	{
                text: "Automated Testing of Complex Web UI Components",
                link: "https://www.inflectra.com/Ideas/Entry/techtuesday-automated-testing-of-complex-web-ui-co-479.aspx"
            },
          	{
                text: "KB301: Ways to slow down test execution",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB301.aspx"
            }             
        ]
    },
    {
        name: "htmlobject.dosettext",
        refs: [
            {
                text: "KB361: Text Validation Does Not Always Fire on Angular4 Application",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB361.aspx"
            }
        ]
    },
    {
        name: "global.doinvoketestparallel",
        refs: [
            {
                text: "Rapise with Selenium Grid - Parallel Test Execution (video)",
                link: "https://youtu.be/L8xMZureYtI"
            },
            {
                text: "Rapise with Selenium Grid - Nested Parallel Test Execution (video)",
                link: "https://youtu.be/5W3KyVH83wc"
            }            
        ]
    },
    {
        name: "uiaobject.dofindelementbycondition",
        refs: [
            {
                text: "KB574: Advanced search for elements in desktop applications",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB574.aspx"
            }
        ]
    },
    {
        name: "uiaobject.dofindelementsbycondition",
        refs: [
            {
                text: "KB574: Advanced search for elements in desktop applications",
                link: "https://www.inflectra.com/Support/KnowledgeBase/KB574.aspx"
            }
        ]
    }
]

function RapiseAnnotateItem(itemName, refs)
{
    var el = null;
    var res = $("a[name='see.also." + itemName.toLowerCase() + "']");
    if (res && res.length == 1)
    {
        el = res[0];
    }
    if (el)
    {
        var d = document.createElement('div');
        var titleHtml = "<p><br/><span style='font-weight: bold;'>See Also</span></p>"
        d.innerHTML = titleHtml;

        // create references section
        for(var i = 0; i < refs.length; i++)
        {
            var r = refs[i];
            var p = document.createElement('p');
            var linkHtml = "<a target='_blank' href='" + r.link + "'>" + r.text + "</a>";
            p.innerHTML = linkHtml;
            d.appendChild(p);
        } 
        
        // attach references
        if (el.parentNode.nextSibling) 
        {
            el.parentNode.parentNode.insertBefore(d, el.parentNode.nextSibling);
        }
        else 
        {
            el.parentNode.parentNode.appendChild(d);
        }
    }
}

function RapiseAnnotateDocument(annotations)
{
    if (typeof(document.rapiseAnnotated) != "undefined")
    {
        return;        
    }
    else
    {
        document.rapiseAnnotated = true;        
    }
    
    for(var i = 0; i < annotations.length; i++)
    {
        var annotation = annotations[i];
        RapiseAnnotateItem(annotation.name, annotation.refs);    
    } 
}

function RegisterKeywordSearch()
{
    function guid() {
      function s4() {
        return Math.floor((1 + Math.random()) * 0x10000)
          .toString(16)
          .substring(1);
      }
      return s4() + s4() + '-' + s4() + '-' + s4() + '-' +
        s4() + '-' + s4() + s4() + s4();
    }	    
    
    var getParams = function (url) {
        var params = {};
        var parser = document.createElement('a');
        parser.href = url;
        var query = parser.search.substring(1);
        var vars = query.split('&');
        for (var i = 0; i < vars.length; i++) {
            var pair = vars[i].split('=');
            params[pair[0]] = decodeURIComponent(pair[1]);
        }
        return params;
    };

    if (typeof ga != "undefined")
    {
        var params = getParams(window.location.href);
        var kw = params["kw"];

        if (typeof kw != "undefined")
        {
            ga('require', 'ecommerce');
            ga('ecommerce:addItem', {
              'id': guid(),                     // Transaction ID. Required.
              'name': kw,                       // Product name. Required.
              'sku': window.location.href,      // SKU/code.
              'category': 'Keywords',           // Category or variation.
              'price': '1.00',                  // Unit price.
              'quantity': '1',                  // Quantity.
              'currency': 'USD'
            });
            ga('ecommerce:send');
        }
    }   
}

function RegisterKbClick(id, title)
{
    if (typeof ga != "undefined")
    {
        ga('send', 'event', 'KB', 'click', id + ' ' + title);
    }
    return true;
}

$(document).ready(function() {

    RapiseAnnotateDocument(annotations);
    RegisterKeywordSearch()
 
});
